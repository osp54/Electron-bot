import nextcord as discord
from nextcord.ext import commands, tasks
import psutil
import os
import time

class status(commands.Cog):
    def __init__(self, bot):
        self.bot = bot
    tot_m, used_m, free_m = map(int, os.popen('free -t -m').readlines()[-1].split()[1:])

    @commands.Cog.listener()
    async def on_ready():
        sping.start()

    @tasks.loop(seconds=30)
    async def sping():
        channel = client.get_channel(881924597472178176)
        msg = await channel.fetch_message(881924714073845760)
        embed = discord.Embed(
            title = "Статистика",
            description = f"Статистика нагрузки на хостинг бота.\nПоследнее обновление статуса: \n{datetime.now()}",
            color = 0x00A725
        )
        emb.add_field( name = "CPU", value = f"Нагрузка на процессор: {psutil.cpu_percent()}% ", inline = False)
        emb.add_field( name = "RAM", value = f"ОЗУ: {used_m}MB/{tot_m}MB", inline = True)
        await msg.edit(embed = emb)
 def setup(bot):
     bot.add_cog(status(bot))
